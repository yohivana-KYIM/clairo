{% extends 'base.html.twig' %}

{% block title %}Erreur dâ€™authentification 2FA{% endblock %}

{% block body %}
    <div class="container py-5" style="max-width: 520px;">

        <div class="card shadow-lg p-4 border-0">

            <div class="text-center mb-3">
                <div class="display-4 text-danger">âš ï¸</div>
                <h3 class="fw-bold mt-2">Ã‰chec de la vÃ©rification</h3>
            </div>

            <p class="text-muted text-center mb-4">
                Lâ€™authentification Ã  deux facteurs nâ€™a pas pu Ãªtre complÃ©tÃ©e.
            </p>

            {# MESSAGE Dâ€™ERREUR EXPLICITE #}
            {% if error %}
                <div class="alert alert-danger text-center fw-bold">
                    {{ error }}
                </div>
            {% endif %}

            {# ACTIONS POSSIBLES #}
            <div class="d-grid gap-3 mt-4">

                {# RÃ©essayer : retourne Ã  lâ€™Ã©cran 2FA #}
                <a href="{{ path('2fa_login') }}"
                   class="btn btn-cleo py-2 fs-5">
                    ğŸ” RÃ©essayer
                </a>

                {# Si plusieurs providers existent, permettre de changer de mÃ©thode #}
                {% if availableTwoFactorProviders is defined and availableTwoFactorProviders|length > 1 %}
                    <a href="{{ path('2fa_login', {'preferProvider': null}) }}"
                       class="btn btn-outline-primary py-2">
                        ğŸ”„ Choisir une autre mÃ©thode
                    </a>
                {% endif %}

                {# DÃ©connexion #}
                <a href="{{ path('app_logout') }}"
                   class="btn btn-danger py-2">
                    ğŸšª Se dÃ©connecter
                </a>
            </div>

            {# Assistance / Help (optionnel, trÃ¨s pro) #}
            <div class="text-center mt-4">
                <small class="text-muted">
                    Besoin dâ€™aide ? Contactez le support sÃ©curitÃ©.
                </small>
            </div>

        </div>
    </div>
{% endblock %}
